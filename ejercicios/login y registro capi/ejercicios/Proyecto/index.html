<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Admin</title>
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<!-- bootstrap 4-->
	<link rel="stylesheet" type="text/css" href="../../plugins/bootstrap/css/bootstrap.min.css">
	<!-- fontawesome -->
	<link rel="stylesheet" href="../../plugins/fontawesome-free-5.8.1-web/css/all.min.css">
	<!-- Estilo personalizado -->
	<link rel="stylesheet" type="text/css" href="../../css/estilos.css">
	<!-- bootstrap-toggle-master -->
	<link href="../../plugins/bootstrap-toggle-master/css/bootstrap-toggle.css" rel="stylesheet">
	<!--<link href="../../plugins/bootstrap-toggle-master/stylesheet.css" rel="stylesheet">-->
	<!-- alertify -->
	<link href="../../plugins/alertifyjs/css/alertify.css" rel="stylesheet">	
	<link href="../../plugins/alertifyjs/css/themes/default.css" rel="stylesheet">	
	<!-- animate -->
	<link rel="stylesheet" href="../../plugins/animate/animate.css">
	<!-- DataTables -->
	<!--<link rel="stylesheet" href="../../plugins/Table/DataTables/DataTables-1.10.16/css/jquery.dataTables.min.css">-->
	
	<!--CSS Bootstrap -->
	<!--<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">-->
	<link rel="stylesheet" href="https://cdn.datatables.net/1.10.20/css/dataTables.bootstrap.min.css">
	<link rel="stylesheet" href="https://cdn.datatables.net/buttons/1.6.1/css/buttons.bootstrap.min.css">

</head>
<body>
	
	<form id="usuarios" name="usuarios" method="POST" >
	<div class="container-fluid tamContenido">
		<div class="row">
			<div class="col-xs-12 col-sm-9 col-md-12 col-lg-12 cont">
			   <div class="titulo borde sombra">
			        <h3 class="animated zoomIn tPrincipal">Registrar Usuarios</h3>
			   </div>	
			   <div class="contenido borde sombra" style="padding-right:18px;">
				   <!--Inicio de Ejercicio-->
				   <div class="container-fluid">
					<!-- Elementos -->
					<div class="formulario animated  slideInUp">
						<form role="form" class="interno"  method="POST" id="form_datos">
							<div class="cuerpo">
								<input type="hidden" name="id" id="id">
								<div class="row">
									<div class="col-xs-12 col-sm-7 col-md-6 col-lg-4">
										<div class="form-group">
											<label for="usuario">Usuario:</label>
											<input type="text" class="form-control" id="usuario">
										</div>
									</div>
									<div class="col-xs-12 col-sm-5 col-md-6 col-lg-4">
										<div class="form-group">
											<label for="nombres">Nombres:</label>
											<input type="text" class="form-control" id="nombres">
										</div>
									</div>
									<div class="col-xs-12 col-sm-12 col-md-12 col-lg-4">
										<div class="form-group">
											<label for="pass">Password :</label>
											<input type="text" class="form-control" id="pass">
										</div>
									</div>

								</div>
							</div>
							<div class="pie">
								<button type="button" id="guardar" class="btn btn-form">Guardar</button>
								<button type="button" id="cancelar" class="btn btn-form"> Cancelar</button>
								<button type="button" id="salir" class="btn btn-form" onclick="salida();">Salir</button>
							</div>
						</form>
					</div>
					<!--Contenido de la tabla-->
					<div class="formulario animated  slideInUp">
						<form role="form" class="interno">
							<div class="encabezado">
								Tabla Usuarios
							</div>
							<div class="row">
								<div class="col-md-12" id="tabla">
								  <div class="table-responsive">
									<table id="lista_usuarios" class="table table-striped table-bordered" cellspacing="0" width="100%">
										<br>			
										<thead>
										<tr>
										  <th width="5%">#</th>
										  <th>Usuario</th>
										  <th>Nombres</th>
										  <th>Contraseña</th>
										  <th>Opciones</th>
										</tr>
									  </thead>
									  <tbody>
										<tr>
										  <th>#</th>
										  <th>Usuario</th>
										  <th>Nombres</th>                
										  <th>Contraseña</th>
										  <th>Opciones</th>
										</tr>
									  </tbody>  
									</table>
								  </div>
								</div>
							  </div>				  
						</form>		
					</div>
					</div>
			   </div>	
			</div>			
		</div>
	</div>
</form>
	
	<script src="../../plugins/jQuery/jQuery-2.1.4.min.js"></script>
	<!-- alertify -->
	<script src="../../plugins/alertifyjs/alertify.js"></script>
	<!-- bootstrap -->
	<script src="../../plugins/bootstrap/js/bootstrap.min.js"></script>
	<!-- preloaders -->
	<script src="../../plugins/Preloaders/jquery.preloaders.js"></script>
	<!-- bootstrap-toggle-master -->
	<script src="../../plugins/bootstrap-toggle-master/doc/script.js"></script>
	<script src="../../plugins/bootstrap-toggle-master/js/bootstrap-toggle.js"></script>

	
	<!-- DataTables -->
	<script src="../../plugins/Table/DataTables/DataTables-1.10.16/js/jquery.dataTables.min.js"></script>
	<script src="https://cdn.datatables.net/1.10.20/js/dataTables.bootstrap.min.js"></script>
	<script src="https://cdn.datatables.net/buttons/1.6.1/js/dataTables.buttons.min.js"></script>
	<script src="https://cdn.datatables.net/buttons/1.6.1/js/buttons.bootstrap.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.3/jszip.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/pdfmake.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/vfs_fonts.js"></script>
	<script src="https://cdn.datatables.net/buttons/1.6.1/js/buttons.html5.min.js"></script>
	<script src="https://cdn.datatables.net/buttons/1.6.1/js/buttons.print.min.js"></script>
	<script src="https://cdn.datatables.net/buttons/1.6.1/js/buttons.colVis.min.js"></script>

	<!-- Scripts personalizados -->
	<!--Funciones-->
	<script type="text/javascript">
		window.onload = function() {


			$("#guardar").css("background","green");
			$("#guardar").css("color","white");

			$("#cancelar").css("background","red");
			$("#cancelar").css("color","white");


			$("#usuario").val("");
			$("#nombres").val("");
			$("#pass").val("");
			
		};
		function tabla_usuarios () {
		 $('#lista_usuarios').dataTable().fnDestroy();
		 $('#lista_usuarios').DataTable( {
		 'language': {"url": "../../plugins/Table/DataTables/Spanish.json"},
			 "paging": false,
			 "dom": 'Bfrtip',
			 "buttons": [
				 'copy', 'csv', 'excel', 'pdf', 'print'
			 ],
		 "ajax": {
			 "type": "POST",
			 "url": "tabla_usuarios.php",
			 "dataSrc": ""
		 },
		 "columns": [
			 { "data": "#" },
			 { "data": "usuario" },
			 { "data": "nombres" },
			 { "data": "pass" },
			 { "data": "opciones" },
		 ]
		 });
		 }  
		 $(document).ready(function() {
			tabla_usuarios();
		 });
 	</script>
 	<script>
		$("#guardar").click(function(){
		if($("#nombres").val()==""||$("#usuario").val()==""||$("#pass").val()==""){
			alertify.error("Favor de llenar todos los campos");
		}
		else{
			var id = $("#id").val();
			var  usuario = $("#usuario").val();
   			var  nombres = $("#nombres").val();
			var  pass = $("#pass").val();
			   
   			var cadena = "id="+id+"&usuario="+usuario+"&nombres="+nombres+"&pass="+pass;
			var url = "insertar_usuario.php";
			$.ajax({
			type: "POST",
			url: url,
			data: cadena, 
			success: function(respuesta)
			{
				if (respuesta=='1') {
					alertify.success("Registro Agregado");
					tabla_usuarios();
					$(":text").val('');
					$("#usuario").val('');
					$("#id").val('');
				}else if(respuesta=='2'){
					alertify.success("Registro Actualizado");
					$(":text").val('');
					$("#id").val('');
					
					tabla_usuarios();
					
				}
				else if(respuesta=='duplicado') {
					alertify.error("Usuario ya Existente");
				}
			}
			});
		}
		});
		$("#cancelar").click(function(){
			$(":text").val('');
			$("#usuario").val('');
			$("#pass").val('');
		});
	</script>
	<script>
	function eliminar(id){
			var url = "eliminar_usuario.php";
			$.ajax({
			url:url,
			data: {id:id},
			type: "POST",
			success: function(respuesta)
			{	
				if(respuesta == "ok"){
					alertify.error("Registro Eliminado");
					$("#usuario").val("");
			$("#nombres").val("");
			$("#pass").val("")
					tabla_usuarios();
				}
			},
			error: function (xhr, status)
			{
				alertify.error("Error");

			}
		});
	}
	function consulta_datos(id){
    var url = "consultar_datos.php";
    $.ajax({
     type: "POST",
     url: url,
     data: {id:id},
     success: function(respuesta)
     {
      var array = eval(respuesta);
	  $('#id').val(array[0]);
      $('#usuario').val(array[1]);
      $('#nombres').val(array[2]);
      $('#pass').val(array[3]);
     }
   });
  };
	</script>
	<script>
		window.load()
	
	</script>

	
	<script>
			function salida(){
				window.location='../Login/index.php';
			}
			</script>
</body>
</html>